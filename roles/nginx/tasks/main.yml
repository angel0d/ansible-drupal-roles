---
- group_by: key={{ ansible_os_family }}

- name: Install nginx on Ubuntu
  apt: name=nginx
  when: ansible_os_family == 'Debian'

- name: Enable nginx repo on CentOS
  yum: name=http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm
  when: ansible_os_family == 'RedHat'

- name: Install nginx on CentOS
  yum: name=nginx
  when: ansible_os_family == 'RedHat'

- name: Clone drupal.conf from repository
  git: repo=https://github.com/axai-mx/simple-drupal-nginx.git dest=/etc/nginx/simple-drupal-nginx/

- name: Ensure nginx is started and enabled to start at boot.
  service: name=nginx state=started enabled=yes
